import{a as ye}from"./chunk-RTUFD3NC.js";import{a as J,b as Ee}from"./chunk-G6EORHDL.js";import{b as k}from"./chunk-G3PMQNUP.js";import{a as R,b as me,c as de,e as pe,h as fe,i as G,j as ue,k as he,l as _e,n as ge,p as Ce,s as Se}from"./chunk-NPJDO2MN.js";import{x as ve}from"./chunk-FXWHQ5QQ.js";import{$ as ie,A as d,B as F,C as f,D as u,E as a,Ea as H,F as _,Fa as se,G as w,H as X,I as V,Ia as ce,J as P,K as O,L as K,M as Y,N as Z,Q as $,R as B,S as ee,T as I,_ as te,aa as ne,ea as W,fa as b,ga as L,ha as oe,i as h,ia as re,ja as ae,la as le,m as g,ma as q,n as C,na as N,oa as x,p as E,pa as T,qa as M,s,t as y,ta as z,v as U,w as D,wa as A,x as m,xa as j,y as i,z as n}from"./chunk-3UZMSI2G.js";import"./chunk-4EWL26LU.js";import"./chunk-KDDLO6BQ.js";import"./chunk-4EOFL5AI.js";import"./chunk-REDFVHFG.js";import"./chunk-WTJTNUM2.js";import"./chunk-6TYOTTQG.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-LRFGNCHE.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{i as v}from"./chunk-VBFW7A5V.js";function Te(l,o){l&1&&d(0,"ion-spinner",10)}var Ie=(()=>{let o=class o{constructor(){this.salvo=new E,this.cancelado=new E,this.clienteService=h(J),this.alertService=h(k),this.form={nome:"",telefone:"",email:"",endereco:""},this.editando=!1,this.carregando=!1}ngOnInit(){this.cliente&&(this.editando=!0,this.form={nome:this.cliente.nome,telefone:this.cliente.telefone,email:this.cliente.email,endereco:this.cliente.endereco})}salvar(){return v(this,null,function*(){if(this.validarFormulario()){this.carregando=!0;try{this.editando&&this.cliente?.id?(yield this.clienteService.atualizarCliente(this.cliente.id,this.form),yield this.alertService.showSuccess("Cliente atualizado com sucesso!")):(yield this.clienteService.adicionarCliente(this.form),yield this.alertService.showSuccess("Cliente cadastrado com sucesso!")),this.salvo.emit(),this.limparFormulario()}catch(e){yield this.alertService.showError("Erro ao salvar cliente: "+e.message)}finally{this.carregando=!1}}})}cancelar(){this.cancelado.emit(),this.limparFormulario()}validarFormulario(){return!this.form.nome||this.form.nome.trim().length<3?(this.alertService.showError("Nome deve ter pelo menos 3 caracteres"),!1):this.form.telefone?this.form.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.form.email)?!0:(this.alertService.showError("Email inv\xE1lido"),!1):(this.alertService.showError("Email \xE9 obrigat\xF3rio"),!1):(this.alertService.showError("Telefone \xE9 obrigat\xF3rio"),!1)}limparFormulario(){this.form={nome:"",telefone:"",email:"",endereco:""},this.editando=!1}};o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=y({type:o,selectors:[["app-cliente-form"]],inputs:{cliente:"cliente"},outputs:{salvo:"salvo",cancelado:"cancelado"},decls:29,vars:13,consts:[["slot","end"],[3,"click","disabled"],["position","stacked"],["type","text","placeholder","Digite o nome completo",3,"ngModelChange","ngModel","disabled"],["type","tel","placeholder","(00) 00000-0000",3,"ngModelChange","ngModel","disabled"],["type","email","placeholder","email@exemplo.com",3,"ngModelChange","ngModel","disabled"],["placeholder","Digite o endere\xE7o completo",3,"ngModelChange","ngModel","disabled"],[1,"ion-padding"],["expand","block","color","primary",3,"click","disabled"],["slot","start",4,"ngIf"],["slot","start"]],template:function(r,t){r&1&&(i(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),a(3),n(),i(4,"ion-buttons",0)(5,"ion-button",1),f("click",function(){return t.cancelar()}),a(6,"Cancelar"),n()()()(),i(7,"ion-content")(8,"ion-list")(9,"ion-item")(10,"ion-label",2),a(11,"Nome *"),n(),i(12,"ion-input",3),O("ngModelChange",function(p){return P(t.form.nome,p)||(t.form.nome=p),p}),n()(),i(13,"ion-item")(14,"ion-label",2),a(15,"Telefone *"),n(),i(16,"ion-input",4),O("ngModelChange",function(p){return P(t.form.telefone,p)||(t.form.telefone=p),p}),n()(),i(17,"ion-item")(18,"ion-label",2),a(19,"Email *"),n(),i(20,"ion-input",5),O("ngModelChange",function(p){return P(t.form.email,p)||(t.form.email=p),p}),n()(),i(21,"ion-item")(22,"ion-label",2),a(23,"Endere\xE7o"),n(),i(24,"ion-textarea",6),O("ngModelChange",function(p){return P(t.form.endereco,p)||(t.form.endereco=p),p}),n()()(),i(25,"div",7)(26,"ion-button",8),f("click",function(){return t.salvar()}),D(27,Te,1,0,"ion-spinner",9),a(28),n()()()),r&2&&(s(3),_(t.editando?"Editar Cliente":"Novo Cliente"),s(2),m("disabled",t.carregando),s(7),V("ngModel",t.form.nome),m("disabled",t.carregando),s(4),V("ngModel",t.form.telefone),m("disabled",t.carregando),s(4),V("ngModel",t.form.email),m("disabled",t.carregando),s(4),V("ngModel",t.form.endereco),m("disabled",t.carregando),s(2),m("disabled",t.carregando),s(),m("ngIf",t.carregando),s(),w(" ",t.editando?"Atualizar":"Cadastrar"," Cliente "))},dependencies:[I,B,ne,te,ie,q,N,j,A,L,b,M,x,T,se,ce,z],encapsulation:2});let l=o;return l})();var be=(()=>{let o=class o{transform(e){return e?e instanceof ve?e.toDate():e instanceof Date?e:typeof e=="string"?new Date(e):e&&typeof e.toDate=="function"?e.toDate():(console.warn("TimestampPipe: Valor n\xE3o reconhecido:",e),null):null}};o.\u0275fac=function(r){return new(r||o)},o.\u0275pipe=U({name:"timestamp",type:o,pure:!0});let l=o;return l})();var xe=(()=>{let o=class o{constructor(){this.voltar=new E,this.editar=new E,this.equipamentoService=h(Ee),this.osService=h(ye),this.alertService=h(k),this.estatisticas={totalEquipamentos:0,totalOS:0},R({person:Ce,call:pe,mail:ge,location:_e,hardwareChip:he,construct:fe,arrowBack:de,create:G})}ngOnInit(){this.carregarEstatisticas()}carregarEstatisticas(){return v(this,null,function*(){if(this.cliente.id)try{this.equipamentoService.obterEquipamentosPorCliente(this.cliente.id).subscribe(e=>{this.estatisticas.totalEquipamentos=e.length}),this.osService.obterOSPorCliente(this.cliente.id).subscribe(e=>{this.estatisticas.totalOS=e.length})}catch{yield this.alertService.showError("Erro ao carregar estat\xEDsticas")}})}onVoltar(){this.voltar.emit()}onEditar(){this.editar.emit(this.cliente)}};o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=y({type:o,selectors:[["app-cliente-detalhes"]],inputs:{cliente:"cliente"},outputs:{voltar:"voltar",editar:"editar"},decls:57,vars:12,consts:[["slot","start"],["name","person","color","primary"],["name","call","slot","start","color","primary"],["name","mail","slot","start","color","primary"],["name","location","slot","start","color","primary"],["name","hardware-chip","slot","start","color","primary"],["name","construct","slot","start","color","primary"],["expand","block","color","primary",2,"margin-top","16px",3,"click"],["slot","start","name","create"],["expand","block","fill","outline","color","medium",2,"margin-top","8px",3,"click"],["slot","start","name","arrow-back"]],template:function(r,t){r&1&&(i(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),a(3,"Detalhes do Cliente"),n()(),i(4,"ion-card-content")(5,"ion-list")(6,"ion-item")(7,"ion-avatar",0),d(8,"ion-icon",1),n(),i(9,"ion-label")(10,"h2"),a(11),n(),i(12,"p"),a(13),K(14,"timestamp"),K(15,"date"),n()()(),i(16,"ion-item"),d(17,"ion-icon",2),i(18,"ion-label")(19,"h3"),a(20,"Telefone"),n(),i(21,"p"),a(22),n()()(),i(23,"ion-item"),d(24,"ion-icon",3),i(25,"ion-label")(26,"h3"),a(27,"Email"),n(),i(28,"p"),a(29),n()()(),i(30,"ion-item"),d(31,"ion-icon",4),i(32,"ion-label")(33,"h3"),a(34,"Endere\xE7o"),n(),i(35,"p"),a(36),n()()(),i(37,"ion-item"),d(38,"ion-icon",5),i(39,"ion-label")(40,"h3"),a(41,"Equipamentos"),n(),i(42,"p"),a(43),n()()(),i(44,"ion-item"),d(45,"ion-icon",6),i(46,"ion-label")(47,"h3"),a(48,"Ordens de Servi\xE7o"),n(),i(49,"p"),a(50),n()()()(),i(51,"ion-button",7),f("click",function(){return t.onEditar()}),d(52,"ion-icon",8),a(53," Editar Cliente "),n(),i(54,"ion-button",9),f("click",function(){return t.onVoltar()}),d(55,"ion-icon",10),a(56," Voltar "),n()()()),r&2&&(s(11),_(t.cliente.nome),s(2),w("Cliente desde: ",Z(15,9,Y(14,7,t.cliente.dataCadastro),"dd/MM/yyyy"),""),s(9),_(t.cliente.telefone),s(7),_(t.cliente.email),s(7),_(t.cliente.endereco),s(7),w("",t.estatisticas.totalEquipamentos," equipamentos cadastrados"),s(7),w("",t.estatisticas.totalOS," OS realizadas"))},dependencies:[I,ee,oe,ae,le,re,M,x,H,T,W,b,be],encapsulation:2});let l=o;return l})();function Me(l,o){if(l&1){let c=F();i(0,"ion-item")(1,"ion-avatar",10),d(2,"ion-icon",11),n(),i(3,"ion-label")(4,"h2"),a(5),n(),i(6,"p"),a(7),n(),i(8,"p"),a(9),n()(),i(10,"ion-buttons",2)(11,"ion-button",12),f("click",function(){let r=g(c).$implicit,t=u();return C(t.visualizarCliente(r))}),d(12,"ion-icon",13),n(),i(13,"ion-button",14),f("click",function(){let r=g(c).$implicit,t=u();return C(t.editarCliente(r))}),d(14,"ion-icon",15),n(),i(15,"ion-button",16),f("click",function(){let r=g(c).$implicit,t=u();return C(t.excluirCliente(r))}),d(16,"ion-icon",17),n()()()}if(l&2){let c=o.$implicit;s(5),_(c.nome),s(2),X("",c.telefone," - ",c.email,""),s(2),_(c.endereco)}}function ke(l,o){l&1&&(i(0,"div",18),d(1,"ion-spinner"),i(2,"p"),a(3,"Carregando clientes..."),n()())}function De(l,o){if(l&1){let c=F();i(0,"div",18)(1,"p"),a(2,"Nenhum cliente cadastrado"),n(),i(3,"ion-button",3),f("click",function(){g(c);let r=u();return C(r.novoCliente())}),a(4,"Cadastrar Primeiro Cliente"),n()()}}function Fe(l,o){if(l&1){let c=F();i(0,"app-cliente-form",19),f("salvo",function(){g(c);let r=u();return C(r.onClienteSalvo())})("cancelado",function(){g(c);let r=u();return C(r.onClienteCancelado())}),n()}if(l&2){let c=u();m("cliente",c.clienteEditando)}}function Ve(l,o){if(l&1){let c=F();i(0,"app-cliente-detalhes",20),f("voltar",function(){g(c);let r=u();return C(r.onVoltarDetalhes())})("editar",function(r){g(c);let t=u();return C(t.onEditarDetalhes(r))}),n()}if(l&2){let c=u();m("cliente",c.clienteSelecionado)}}var gt=(()=>{let o=class o{constructor(){this.clienteService=h(J),this.alertService=h(k),this.clientes=[],this.carregando=!1,this.mostrarFormulario=!1,this.mostrarDetalhes=!1,R({add:me,create:G,trash:Se,eye:ue})}ngOnInit(){this.carregarClientes()}carregarClientes(){return v(this,null,function*(){this.carregando=!0;try{this.clienteService.obterClientes().subscribe({next:e=>{console.log("\u2705 Clientes carregados:",e),this.clientes=e,this.carregando=!1},error:e=>v(this,null,function*(){console.error("\u274C Erro ao carregar clientes:",e),yield this.alertService.showError("Erro ao carregar clientes: "+e.message),this.carregando=!1})})}catch(e){console.error("\u274C Erro no carregarClientes:",e),yield this.alertService.showError("Erro ao carregar clientes: "+e.message),this.carregando=!1}})}novoCliente(){this.clienteEditando=void 0,this.mostrarFormulario=!0,this.mostrarDetalhes=!1}editarCliente(e){this.clienteEditando=e,this.mostrarFormulario=!0,this.mostrarDetalhes=!1}visualizarCliente(e){this.clienteSelecionado=e,this.mostrarDetalhes=!0,this.mostrarFormulario=!1}excluirCliente(e){return v(this,null,function*(){if((yield this.alertService.showConfirm("Confirmar Exclus\xE3o",`Deseja realmente excluir o cliente ${e.nome}?`))&&e.id)try{yield this.clienteService.excluirCliente(e.id),yield this.alertService.showSuccess("Cliente exclu\xEDdo com sucesso!"),this.carregarClientes()}catch(t){yield this.alertService.showError("Erro ao excluir cliente: "+t.message)}})}onClienteSalvo(){this.mostrarFormulario=!1,this.clienteEditando=void 0,this.carregarClientes()}onClienteCancelado(){this.mostrarFormulario=!1,this.clienteEditando=void 0}onVoltarDetalhes(){this.mostrarDetalhes=!1,this.clienteSelecionado=void 0}onEditarDetalhes(e){this.mostrarDetalhes=!1,this.editarCliente(e)}};o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=y({type:o,selectors:[["app-clientes"]],decls:14,vars:7,consts:[[3,"translucent"],["color","primary"],["slot","end"],[3,"click"],["slot","icon-only","name","add"],[3,"fullscreen"],[4,"ngFor","ngForOf"],["class","ion-text-center ion-padding",4,"ngIf"],[3,"cliente","salvo","cancelado",4,"ngIf"],[3,"cliente","voltar","editar",4,"ngIf"],["slot","start"],["name","person","color","medium"],["fill","clear","color","primary",3,"click"],["slot","icon-only","name","eye"],["fill","clear","color","warning",3,"click"],["slot","icon-only","name","create"],["fill","clear","color","danger",3,"click"],["slot","icon-only","name","trash"],[1,"ion-text-center","ion-padding"],[3,"salvo","cancelado","cliente"],[3,"voltar","editar","cliente"]],template:function(r,t){r&1&&(i(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),a(3,"Clientes"),n(),i(4,"ion-buttons",2)(5,"ion-button",3),f("click",function(){return t.novoCliente()}),d(6,"ion-icon",4),n()()()(),i(7,"ion-content",5)(8,"ion-list"),D(9,Me,17,4,"ion-item",6),n(),D(10,ke,4,0,"div",7)(11,De,5,0,"div",7)(12,Fe,1,1,"app-cliente-form",8)(13,Ve,1,1,"app-cliente-detalhes",9),n()),r&2&&(m("translucent",!0),s(7),m("fullscreen",!0),s(2),m("ngForOf",t.clientes),s(),m("ngIf",t.carregando),s(),m("ngIf",t.clientes.length===0&&!t.carregando),s(),m("ngIf",t.mostrarFormulario),s(),m("ngIf",t.mostrarDetalhes&&t.clienteSelecionado))},dependencies:[I,$,B,N,j,A,L,b,q,M,x,T,H,W,Ie,xe,z],encapsulation:2});let l=o;return l})();export{gt as ClientesPage};
